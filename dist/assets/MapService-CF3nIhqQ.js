import{C as p}from"./index-Q4aJbjSp.js";const l={mapInstanceDisplay:null,mapInstancePicker:null,pickerMarker:null,initDisplayMap(e,n){if(this.mapInstanceDisplay){try{this.mapInstanceDisplay.remove()}catch(i){console.warn("Error removing previous display map:",i)}this.mapInstanceDisplay=null}const r=typeof e=="string"?document.getElementById(e):e;if(!r)return console.warn("Map display container not found for initDisplayMap."),null;r.innerHTML="";let t=p.DEFAULT_MAP_CENTER,s=p.DEFAULT_MAP_ZOOM;if(n&&n.length>0){const i=n.filter(o=>o.lat&&o.lon);i.length>0&&(t=[i[0].lat,i[0].lon],s=i.length>1?6:10)}this.mapInstanceDisplay=window.L.map(r).setView(t,s);const a={};return Object.entries(p.TILE_LAYERS).forEach(([i,o])=>{a[i]=window.L.tileLayer(o.url,{attribution:o.attribution,maxZoom:19})}),Object.keys(a).length>0&&(a[Object.keys(a)[0]].addTo(this.mapInstanceDisplay),Object.keys(a).length>1&&window.L.control.layers(a,null,{collapsed:!1}).addTo(this.mapInstanceDisplay)),n&&n.forEach(i=>{i.lat&&i.lon&&window.L.marker([i.lat,i.lon]).addTo(this.mapInstanceDisplay).bindPopup(`<b>${i.name||"Cerita"}</b><br>${(i.description||"").substring(0,50)}...`)}),this.mapInstanceDisplay},initPickerMap(e,n){if(this.mapInstancePicker){try{this.mapInstancePicker.remove()}catch(s){console.warn("Error removing previous picker map:",s)}this.mapInstancePicker=null,this.pickerMarker=null}const r=typeof e=="string"?document.getElementById(e):e;if(!r)return console.warn("Map picker container not found for initPickerMap."),null;r.innerHTML="",this.mapInstancePicker=window.L.map(r).setView(p.DEFAULT_MAP_CENTER,p.DEFAULT_MAP_ZOOM);const t={};return Object.entries(p.TILE_LAYERS).forEach(([s,a])=>{t[s]=window.L.tileLayer(a.url,{attribution:a.attribution,maxZoom:19})}),Object.keys(t).length>0&&(t[Object.keys(t)[0]].addTo(this.mapInstancePicker),Object.keys(t).length>1&&window.L.control.layers(t,null,{collapsed:!0}).addTo(this.mapInstancePicker)),this.mapInstancePicker.on("click",s=>{const{lat:a,lng:i}=s.latlng;this.pickerMarker?this.pickerMarker.setLatLng(s.latlng):this.pickerMarker=window.L.marker(s.latlng).addTo(this.mapInstancePicker),this.pickerMarker.bindPopup(`Lokasi dipilih: ${a.toFixed(5)}, ${i.toFixed(5)}`).openPopup(),typeof n=="function"&&n(a,i)}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{const{latitude:a,longitude:i}=s.coords;this.mapInstancePicker&&(this.mapInstancePicker.setView([a,i],13),this.pickerMarker?this.pickerMarker.setLatLng([a,i]):this.pickerMarker=window.L.marker([a,i]).addTo(this.mapInstancePicker),this.pickerMarker.bindPopup("Lokasi Anda saat ini. Klik peta untuk mengubah.").openPopup(),typeof n=="function"&&n(a,i))},()=>{console.warn("Gagal mendapatkan geolokasi atau izin ditolak.")}),this.mapInstancePicker},panToLocation(e,n){this.mapInstanceDisplay&&(this.mapInstanceDisplay.setView([e,n],15),this.mapInstanceDisplay.eachLayer(r=>{if(r instanceof window.L.Marker){const t=r.getLatLng();t.lat===e&&t.lng===n&&r.openPopup()}}))},destroyPickerMap(){if(this.mapInstancePicker){try{this.mapInstancePicker.remove()}catch(e){console.warn("Error destroying picker map:",e)}this.mapInstancePicker=null,this.pickerMarker=null}},destroyDisplayMap(){if(this.mapInstanceDisplay){try{this.mapInstanceDisplay.remove()}catch(e){console.warn("Error destroying display map:",e)}this.mapInstanceDisplay=null}}};export{l as default};
